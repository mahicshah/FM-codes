import java.awt.*;
import  java.io.*;
import java.util.Iterator;
import java.util.Scanner;
import  org.apache.poi.hssf.usermodel.HSSFSheet;
import  org.apache.poi.hssf.usermodel.HSSFWorkbook;
import  org.apache.poi.hssf.usermodel.HSSFRow;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import java.io.IOException;

public class Excel {

    static void xlsx(File inputFile, File outputFile) {
        StringBuffer data = new StringBuffer();

        try {
            FileOutputStream fos = new FileOutputStream(outputFile);
            HSSFWorkbook wBook = new HSSFWorkbook(new FileInputStream(inputFile));
            HSSFSheet sheet = wBook.getSheetAt(0);
            Row row;
            Cell cell;

            Iterator<Row> rowIterator = sheet.iterator();

            while (rowIterator.hasNext()) {
                row = rowIterator.next();

                Iterator<Cell> cellIterator = row.cellIterator();
                while (cellIterator.hasNext()) {

                    cell = cellIterator.next();

                    data.append(cell.getStringCellValue() + ",");
                }
            }
            fos.write(data.toString().getBytes());
            fos.close();

        } catch (Exception ioe) {
            ioe.printStackTrace();
        }
    }

    public static void main(String[] args) throws IOException {
        String filename = "/Users/MahicShah/Downloads/FM Coding Tasks/excelsheet.xls";
        HSSFWorkbook workbook = new HSSFWorkbook();
        HSSFSheet sheet = workbook.createSheet("excelsheet");

        File text = new File("/Users/MahicShah/Downloads/FM Coding Tasks/textfile.txt");
        Scanner sc = new Scanner(text);
        Scanner in = new Scanner(System.in);

        System.out.print("Enter the number of rows in the text file: ");
        int rows = in.nextInt();

        String[][] array = new String[rows][rows];
        while (sc.hasNextLine()) {
            for (int i = 0; i < array.length; i++) {
                String[] line = sc.nextLine().trim().split(" ");
                for (int j = 0; j < line.length; j++) {
                    array[i][j] = line[j];
                }
            }
        }

        int k, l;

        for (k = 0; k < rows; k++) {
            HSSFRow rowhead = sheet.createRow((short) k);
            for (l = 0; l < rows; l++) {
                rowhead.createCell(l).setCellValue(array[k][l]);
            }
        }
        FileOutputStream fileOut = new FileOutputStream(filename);
        workbook.write(fileOut);
        fileOut.close();
        workbook.close();
        System.out.println("The excel file has been created successfully.");

        Desktop.getDesktop().open(new File("/Users/MahicShah/Downloads/FM Coding Tasks/excelsheet.xls"));

        File inputFile = new File("/Users/MahicShah/Downloads/FM Coding Tasks/excelsheet.xls");
        File outputFile = new File("/Users/MahicShah/Downloads/FM Coding Tasks/data.csv");
        xlsx(inputFile, outputFile);

        System.out.println("The CSV file has been created successfully.");
        Desktop.getDesktop().open(new File("/Users/MahicShah/Downloads/FM Coding Tasks/data.csv"));
    }
}
